---
- hosts: precedents
  become: yes
  gather_facts: no
  tasks:
   - name: check if hosts are accessible
     wait_for:
       host: '{{ (ansible_ssh_host|default(ansible_host))|default(inventory_hostname) }}'
       port: 22
       state: started
       delay: 0
       timeout: 1

   - name: Gather the package facts
     package_facts:
       manager: auto
   - name: Print the package facts
     debug:
       var: ansible_facts.packages
   - name: Print all available facts
     ansible.builtin.debug:
       var: ansible_facts